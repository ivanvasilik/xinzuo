{% style %}
    .section-{{ section.id }} {
        background-color: #111;
    }
{% endstyle %}

<div class="section-background color-{{ section.settings.color_scheme }}"></div>
<div class="section-{{ section.id }} color-{{ section.settings.color_scheme }}">
    <div class="home-products">
        <h2>{{ section.settings.heading }}</h2>
        <div class="home-grid" id="home-products">
            {% assign counter = 0 %}
            {% for product in collections.all.products %}
                {% assign counter = counter | plus: 1 %}
                <div class="product-item" {% if counter > 4 %}style="display:none"{% endif %}>
                    {{ product.title }}
                </div>
            {% endfor %}
        </div>
        <button id="load-more" data-page="1">Load more</button>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const btn = document.querySelector('#load-more');
        const products = document.querySelectorAll('#home-products .product-item');
        let visible = 4;

        btn.addEventListener('click', () => {
            btn.disabled = true;
            btn.textContent = 'Loading...';

            setTimeout(() => {
            for (let i = visible; i < visible + 4; i++) {
                if (products[i]) products[i].style.display = 'block';
            }

            visible += 4;

            btn.disabled = false;
            btn.textContent = 'Load more';

            if (visible >= products.length) btn.remove();
            }, 1000);
        });
    });
</script>

{% schema %}
{
    "name": "Home Products",
    "settings": [
        {
            "type": "text",
            "id": "heading",
            "label": "Heading"
        },
        {
            "type": "color_scheme",
            "id": "color_scheme",
            "label": "t:settings.color_scheme",
            "default": "scheme-1"
        }
    ],
    "presets": [
        {
            "name": "Home Products"
        }
    ]
}
{% endschema %}