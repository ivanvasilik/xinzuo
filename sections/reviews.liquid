{% style %}
  .section-{{ section.id }} {
    background-color: #111;
  }

  .section-{{ section.id }} > div {
    background-color: #111111;
    padding: 80px 0 64px;
    position: relative;
  }

  .section-{{ section.id }} .home-reviews {
    position: relative;
    max-width: 1280px;
    margin: auto;
    margin-bottom: 64px;
  }

  .section-{{ section.id }} .home-reviews h2 {
    color: #fff;
    max-width: 900px;
    font-family: "Sen";
    font-weight: 600;
    font-size: 48px;
    text-align: center;
    margin: auto;
    padding: 0 16px;
    line-height: 130%;
  }

  .section-{{ section.id }} .home-reviews h2 strong {
    color: #ff0004;
    font-weight: 600;
  }

  .section-{{ section.id }} .reviews-carousel {
    position: relative;
    margin-top: 30vw;
    overflow-x: auto;
    overflow-y: hidden;
    scroll-snap-type: x mandatory;
    scroll-behavior: smooth;
    -webkit-overflow-scrolling: touch;
    scrollbar-width: none;
    -ms-overflow-style: none;
    padding: 20px 0;
  }

  .section-{{ section.id }} .reviews-carousel::-webkit-scrollbar {
    display: none;
  }

  .section-{{ section.id }} .reviews-track {
    display: flex;
    gap: 20px;
    padding: 0 calc((100vw - 75%) / 2);
  }

  .section-{{ section.id }} .review-slide {
    flex: 0 0 75%;
    max-width: 500px;
    scroll-snap-align: center;
    opacity: 0.5;
    transform: scale(0.85);
    transition: opacity 0.3s ease, transform 0.3s ease;
  }

  .section-{{ section.id }} .review-slide.active {
    opacity: 1;
    transform: scale(1);
  }

  .section-{{ section.id }} figure.menu-card {
    background-color: #292a33;
    color: #fff;
    font-size: 16px;
    text-align: left;
    position: relative;
    overflow: hidden;
    margin: 0;
    box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.10);
    padding: 48px;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 96px;
    min-height: 350px;
  }

  .section-{{ section.id }} figure.menu-card h2 {
    font-family: "Sen";
    font-weight: 600;
    font-size: 22px;
    margin-bottom: 24px;
    line-height: 140%;
    color: white;
  }

  .section-{{ section.id }} figure.menu-card h5 {
    font-family: "Albert Sans";
    font-weight: 400;
    font-size: 18px;
    color: #c9c9cc;
    margin: 0;
    display: -webkit-box;
    -webkit-box-orient: vertical;
    overflow: hidden;
    text-overflow: ellipsis;
    -webkit-line-clamp: 5;
  }

  .section-{{ section.id }} figure.menu-card .menu-card-bottom {
    width: 100%;
  }

  .section-{{ section.id }} figure.menu-card .menu-card-bottom * {
    text-align: end;
  }

  .section-{{ section.id }} figure.menu-card span {
    font-family: "Albert Sans";
    font-weight: 400;
    font-size: 18px;
    color: white;
    display: block;
  }

  .section-{{ section.id }} .bg-image {
    position: absolute;
    margin-top: -80px;
    width: 100%;
    min-height: 700px;
    object-fit: cover;
  }

  .section-{{ section.id }} svg {
    position: relative;
    margin: auto;
  }

  @media screen and (max-width: 1000px) {
    .section-{{ section.id }} .reviews-carousel {
      margin-top: 350px;
    }
  }

  @media screen and (max-width: 750px) {
    .section-{{ section.id }} > div {
      padding: 48px 0 40px;
    }

    .section-{{ section.id }} .home-reviews h2 {
      font-size: 28px;
    }

    .section-{{ section.id }} .home-reviews {
      margin-bottom: 48px;
    }

    .section-{{ section.id }} .reviews-track {
      padding: 0 calc((100vw - 80%) / 2);
    }

    .section-{{ section.id }} .review-slide {
      flex: 0 0 80%;
    }

    .section-{{ section.id }} figure.menu-card {
      padding: 24px;
      gap: 80px;
      min-height: 380px;
      background: linear-gradient(180deg, #282A33 0%, #0C0C0C 100%);
    }

    .section-{{ section.id }} figure.menu-card h2 {
      font-size: 19px;
      margin-bottom: 12px;
      color: #fff;
      font-family: "Sen";
      font-weight: 600;
      line-height: 140%;
    }

    .section-{{ section.id }} figure.menu-card h5 {
      font-size: 18px;
      line-height: 150%;
    }

    .section-{{ section.id }} .menu-card-bottom p {
      font-size: 16px;
    }

    .section-{{ section.id }} figure.menu-card .menu-cart-top p {
      font-size: 18px;
    }
  }
{% endstyle %}

<section class="section-{{ section.id }}">
  <div>
    <img class="bg-image" src="{{ section.settings.img | image_url: width: 800 }}" width="100%" height="100%" loading="lazy" alt="Review background">
    <svg xmlns="http://www.w3.org/2000/svg" width="88" height="14" viewBox="0 0 88 14" fill="none">
      <g clip-path="url(#clip0_6018_26809)">
        <path d="M3.872 3.38086L5.06 5.76476L7.744 6.15485L5.808 8.01863L6.292 10.6192L3.872 9.40563L1.496 10.6192L1.936 8.01863L0 6.15485L2.684 5.76476L3.872 3.38086Z" fill="white"/>
        <path d="M23.936 3.38086L25.124 5.76476L27.808 6.15485L25.872 8.01863L26.356 10.6192L23.936 9.40563L21.56 10.6192L22 8.01863L20.064 6.15485L22.748 5.76476L23.936 3.38086Z" fill="white"/>
        <path d="M43.9999 3.38086L45.1879 5.76476L47.8719 6.15485L45.9359 8.01863L46.3759 10.6192L43.9999 9.40563L41.6239 10.6192L42.0639 8.01863L40.1279 6.15485L42.8119 5.76476L43.9999 3.38086Z" fill="white"/>
        <path d="M64.0639 3.38086L65.2519 5.76476L67.9359 6.15485L65.9999 8.01863L66.4399 10.6192L64.0639 9.40563L61.6439 10.6192L62.1279 8.01863L60.1919 6.15485L62.8759 5.76476L64.0639 3.38086Z" fill="white"/>
        <path d="M84.1281 3.38086L85.3161 5.76476L88.0001 6.15485L86.0641 8.01863L86.5041 10.6192L84.1281 9.40563L81.7081 10.6192L82.1921 8.01863L80.2561 6.15485L82.9401 5.76476L84.1281 3.38086Z" fill="white"/>
      </g>
      <defs>
        <clipPath id="clip0_6018_26809">
          <rect width="88" height="14" fill="white"/>
        </clipPath>
      </defs>
    </svg>
    <div class="home-reviews">
      <span>{{ section.settings.heading }}</span>
    </div>
    <div class="reviews-carousel" id="reviews-carousel-{{ section.id }}">
      <div class="reviews-track">
        {% for block in section.blocks %}
          <div class="review-slide{% if forloop.first %} active{% endif %}">
            <figure class="menu-card">
              <div class="menu-card-top">
                <h2>{{ block.settings.heading }}</h2>
                <p>{{ block.settings.content }}</p>
              </div>
              <div class="menu-card-bottom">
                <span>{{ block.settings.customer }}</span>
                <p>{{ block.settings.location }}</p>
              </div>
            </figure>
          </div>
        {% endfor %}
      </div>
    </div>
  </div>
</section>

<script>
  (function() {
    var carousel = document.getElementById('reviews-carousel-{{ section.id }}');
    if (!carousel) return;

    var slides = carousel.querySelectorAll('.review-slide');
    if (slides.length < 2) {
      slides[0] && slides[0].classList.add('active');
      return;
    }

    function updateActiveSlide() {
      var carouselRect = carousel.getBoundingClientRect();
      var centerX = carouselRect.left + carouselRect.width / 2;
      var closest = null;
      var closestDist = Infinity;

      slides.forEach(function(slide) {
        var slideRect = slide.getBoundingClientRect();
        var slideCenter = slideRect.left + slideRect.width / 2;
        var dist = Math.abs(slideCenter - centerX);
        if (dist < closestDist) {
          closestDist = dist;
          closest = slide;
        }
        slide.classList.remove('active');
      });

      if (closest) closest.classList.add('active');
    }

    carousel.addEventListener('scroll', updateActiveSlide, { passive: true });
    updateActiveSlide();
  })();
</script>

{% schema %}
{
  "name": "Reviews",
  "settings": [
    {
      "type": "richtext",
      "id": "heading",
      "label": "Heading"
    },
    {
      "type": "image_picker",
      "id": "img",
      "label": "Image"
    }
  ],
  "blocks": [
    {
      "type": "block",
      "name": "Review",
      "settings": [
        {
          "type": "text",
          "id": "heading",
          "label": "Heading"
        },
        {
          "type": "richtext",
          "id": "content",
          "label": "Content"
        },
        {
          "type": "text",
          "id": "customer",
          "label": "Customer"
        },
        {
          "type": "text",
          "id": "location",
          "label": "Location"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Reviews"
    }
  ]
}
{% endschema %}
