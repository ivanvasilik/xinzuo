{% style %}
    .section-{{ section.id }} {
        background-color: #111;
    }

    .section-{{ section.id }} .customers {
        position: relative;
        background-color: black;
        padding: 50px 0;
    }

    .section-{{ section.id }} .customers h2 {
        font-family: "Sen";
        font-weight: 600;
        font-size: 48px;
        color: white;
        text-align: center;
        line-height: 135%;
        padding: 0 16px;
        margin-bottom: 40px;
    }

    .section-{{ section.id }} .customer-imgs {
        width: 100%;
        height: 80px;
        overflow: hidden;
        position: relative;
    }

    .section-{{ section.id }} .marquee-container {
        display: flex;
        width: max-content;
        animation: marquee-{{ section.id }} 30s linear infinite;
    }

    .section-{{ section.id }} .marquee-track {
        display: flex;
        align-items: center;
        gap: 40px;
        padding-right: 40px;
    }

    .section-{{ section.id }} .marquee-track img {
        width: auto;
        height: 60px;
        max-width: 200px;
        display: block;
        object-fit: contain;
        flex-shrink: 0;
    }

    @keyframes marquee-{{ section.id }} {
        0% { transform: translateX(0); }
        100% { transform: translateX(-50%); }
    }

    /* Pause on hover for accessibility */
    .section-{{ section.id }} .customer-imgs:hover .marquee-container {
        animation-play-state: paused;
    }

    @media (prefers-reduced-motion: reduce) {
        .section-{{ section.id }} .marquee-container {
            animation: none;
        }
    }

    @media screen and (max-width: 750px) {
        .section-{{ section.id }} .customers {
            padding: 40px 20px;
        }

        .section-{{ section.id }} .customers h2 {
            padding: 0 16px;
            color: #FFF;
            text-align: center;
            font-family: var(--Primary-Font-Family-Heading, Sen);
            font-size: var(--Mobile-Font-Size-H3, 22px);
            font-style: normal;
            font-weight: var(--Primary-Font-Weight-Semibold, 600);
            line-height: 135%;
            letter-spacing: -0.11px;
            margin-bottom: 30px;
        }

        .section-{{ section.id }} .customer-imgs {
            height: 55px;
        }

        .section-{{ section.id }} .marquee-track {
            gap: 20px;
            padding-right: 20px;
        }

        .section-{{ section.id }} .marquee-track img {
            height: 55px;
            max-width: 150px;
        }
    }
{% endstyle %}

<section class="section-{{ section.id }}">
    <div class="customers">
        <h2>{{ section.settings.heading }}</h2>
        <div class="customer-imgs">
            <div class="marquee-container">
                {%- comment -%} First track {%- endcomment -%}
                <div class="marquee-track">
                    {%- for block in section.blocks -%}
                        {%- if block.settings.image != blank -%}
                            {% liquid
                                assign image = block.settings.image
                                assign alt_text = image.alt | default: 'Customer logo'
                                assign widths = '150, 200, 300, 400'
                                assign sizes = '(min-width: 750px) 200px, 150px'
                                assign loading = 'lazy'
                            %}
                            {{ image | image_url: width: 400 | image_tag:
                                widths: widths,
                                sizes: sizes,
                                loading: loading,
                                fetchpriority: 'low',
                                alt: alt_text,
                                width: 200,
                                height: 60,
                                class: 'customer-logo',
                                style: 'max-width: 200px; height: 60px; object-fit: contain;'
                            }}
                        {%- endif -%}
                    {%- endfor -%}
                </div>
                {%- comment -%} Duplicate track for seamless loop {%- endcomment -%}
                <div class="marquee-track" aria-hidden="true">
                    {%- for block in section.blocks -%}
                        {%- if block.settings.image != blank -%}
                            {% liquid
                                assign image = block.settings.image
                                assign alt_text = image.alt | default: 'Customer logo'
                            %}
                            {{ image | image_url: width: 400 | image_tag:
                                widths: '150, 200, 300, 400',
                                sizes: '(min-width: 750px) 200px, 150px',
                                loading: 'lazy',
                                fetchpriority: 'low',
                                alt: alt_text,
                                width: 200,
                                height: 60,
                                class: 'customer-logo',
                                style: 'max-width: 200px; height: 60px; object-fit: contain;'
                            }}
                        {%- endif -%}
                    {%- endfor -%}
                </div>
            </div>
        </div>
    </div>
</section>

{% schema %}
{
    "name": "Customers",
    "settings": [
        {
            "type": "text",
            "id": "heading",
            "label": "Heading",
            "default": "Trusted by Leading Brands"
        }
    ],
    "blocks": [
        {
            "type": "block",
            "name": "Customer",
            "settings": [
                {
                    "type": "image_picker",
                    "id": "image",
                    "label": "Image"
                }
            ]
        }
    ],
    "presets": [
        {
            "name": "Customers"
        }
    ]
}
{% endschema %}
