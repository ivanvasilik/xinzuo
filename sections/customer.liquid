{% style %}
    .section-{{ section.id }} {
        background-color: #111;
    }

    .section-{{ section.id }} .customers {
        position: relative;
        background-color: black;
        padding: 50px 0;
    }

    .section-{{ section.id }} .customers h2 {
        font-family: "Sen";
        font-weight: 600;
        font-size: 48px;
        color: white;
        text-align: center;
        line-height: 135%;
        padding: 0 16px;
        margin-bottom: 40px;
    }

    .section-{{ section.id }} .swiper-container {
        width: 100%;
        overflow: hidden;
    }

    .section-{{ section.id }} .swiper-wrapper {
        transition-timing-function: linear !important;
    }

    .section-{{ section.id }} .swiper-slide {
        width: auto !important;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .section-{{ section.id }} .customer-imgs {
        width: 100%;
        height: 80px;
        overflow: hidden;
    }

    .section-{{ section.id }} .customer-imgs img {
        width: auto;
        height: 60px;
        display: block;
    }

    @media screen and (max-width: 750px) {
        .section-{{ section.id }} .customers {
            padding: 40px 20px;
        }

        .section-{{ section.id }} .customers h2 {
            padding: 0 16px;
            color: #FFF;
            text-align: center;
            font-family: var(--Primary-Font-Family-Heading, Sen);
            font-size: var(--Mobile-Font-Size-H3, 22px);
            font-style: normal;
            font-weight: var(--Primary-Font-Weight-Semibold, 600);
            line-height: 135%;
            letter-spacing: -0.11px;
            margin-bottom: 30px;
        }

        .section-{{ section.id }} .customer-imgs {
            height: 55px;
        }

        .section-{{ section.id }} .customer-imgs img {
            height: 55px;
        }
    }
{% endstyle %}

<section class="section-{{ section.id }}">
    <div class="customers">
        <h2>{{ section.settings.heading }}</h2>
        <div class="customer-imgs">
            <div class="swiper swiper-container mySwiper_u" >    
                <div class="swiper-wrapper">
                    {%- for block in section.blocks -%}
                        <div class="swiper-slide">
                            <img src="{{ block.settings.image | img_url:'master' }}" width="100%" height="100%" loading="lazy" alt="Customer image">
                        </div>
                    {%- endfor -%}
                    {%- comment -%} Duplicate slides for seamless loop {%- endcomment -%}
                    {%- for block in section.blocks -%}
                        <div class="swiper-slide">
                            <img src="{{ block.settings.image | img_url:'master' }}" width="100%" height="100%" loading="lazy" alt="Customer image">
                        </div>
                    {%- endfor -%}
                </div>
            </div>
        </div>
    </div>
</section>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        var swiperContainer = document.querySelector('.section-{{ section.id }} .mySwiper_u');
        if (!swiperContainer) return;

        var swiper = new Swiper(swiperContainer, {
            slidesPerView: 'auto',
            spaceBetween: 30,
            loop: true,
            speed: 5000,
            autoplay: {
                delay: 0,
                disableOnInteraction: false,
                pauseOnMouseEnter: false,
            },
            freeMode: {
                enabled: true,
                momentum: false,
            },
            grabCursor: false,
            allowTouchMove: false,
            watchSlidesProgress: true,
            observer: true,
            observeParents: true,
            breakpoints: {
                320: {
                    spaceBetween: 20
                },
                750: {
                    spaceBetween: 30
                },
                1024: {
                    spaceBetween: 40
                }
            },
        });

        // Ensure autoplay keeps running
        function ensureAutoplay() {
            if (swiper && swiper.autoplay && !swiper.autoplay.running) {
                swiper.autoplay.start();
            }
        }

        // Restart autoplay when page becomes visible again
        document.addEventListener('visibilitychange', function() {
            if (!document.hidden) {
                ensureAutoplay();
            }
        });

        // Check periodically that autoplay is still running
        setInterval(ensureAutoplay, 3000);

        // Restart on focus
        window.addEventListener('focus', ensureAutoplay);
    });
</script>

{% schema %}
{
    "name": "Customers",
    "settings": [
        {
            "type": "text",
            "id": "heading",
            "label": "Heading",
            "default": "Trusted by Leading Brands"
        }
    ],
    "blocks": [
        {
            "type": "block",
            "name": "Customer",
            "settings": [
                {
                    "type": "image_picker",
                    "id": "image",
                    "label": "Image"
                }
            ]
        }
    ],
    "presets": [
        {
            "name": "Customers"
        }
    ]
}
{% endschema %}