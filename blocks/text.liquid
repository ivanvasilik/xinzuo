<div class="coupon-card" style="--coupon-color: {{ section.settings.lead_color }};">
  <div class="coupon-left">
    <span class="coupon-label">Coupon</span>
    <strong class="coupon-code">{{ section.settings.coupon_code }}</strong>
    <button class="coupon-copy" type="button" data-copy="{{ section.settings.coupon_code }}">Copy</button>
  </div>
  <div class="coupon-right">
    <p class="coupon-text">{{ section.settings.note_text }}</p>
  </div>
</div>

<style>
.coupon-card{
  --c: var(--coupon-color, #e60013);
  display: grid;
  grid-template-columns: 1fr auto;
  gap: 1rem;
  align-items: center;
  padding: 1rem 1.25rem;
  border: 2px dotted var(--c);
  border-radius: 14px;
  background: color-mix(in oklab, var(--c) 5%, white);
  position: relative;
  width: {% if section.settings.width == '100%' %}100%{% else %}fit-content{% endif %};
}
.coupon-card:before,
.coupon-card:after{
  content:"";
  position: absolute;
  top: 50%;
  width: 14px; height: 14px;
  background: #fff;
  border: 2px solid var(--c);
  border-radius: 50%;
  transform: translateY(-50%);
}
.coupon-card:before{ left: -8px; }
.coupon-card:after{ right: -8px; }

.coupon-left{ display:flex; align-items:center; gap:.75rem; flex-wrap:wrap; }
.coupon-label{
  font-size:.75rem; letter-spacing:.06em; text-transform:uppercase;
  padding:.25rem .5rem; border:1px solid var(--c); border-radius:999px;
}
.coupon-code{
  font-family: var(--font-heading--family, inherit);
  font-size: clamp(1rem, 2.6vw, 1.5rem);
  letter-spacing:.08em;
}
.coupon-copy{
  border:1px solid var(--c); background:#fff; border-radius:8px; padding:.4rem .6rem;
  font-size:.85rem; cursor:pointer;
}
.coupon-copy:active{ transform: translateY(1px); }

.coupon-right .coupon-text{ margin:0; font-size:.95rem; opacity:.9; text-wrap: pretty; }
</style>

<script>
document.addEventListener('click', function(e){
  const btn = e.target.closest('.coupon-copy');
  if(!btn) return;
  const code = btn.getAttribute('data-copy');
  navigator.clipboard?.writeText(code).then(()=>{
    const old = btn.textContent;
    btn.textContent = 'Copied';
    setTimeout(()=> btn.textContent = old, 1200);
  });
});
</script>

{% schema %}
{
  "name": "Coupon card",
  "settings": [
    { "type": "text", "id": "coupon_code", "label": "Coupon code", "default": "XINZUO20" },
    { "type": "text", "id": "note_text", "label": "Subtext", "default": "Use this coupon for 20% off at checkout." },
    { "type": "color", "id": "lead_color", "label": "Accent color", "default": "#e60013" },
    {
      "type": "select",
      "id": "width",
      "label": "Width",
      "options": [
        { "value": "fit-content", "label": "Fit" },
        { "value": "100%", "label": "Fill" }
      ],
      "default": "fit-content"
    }
  ],
  "presets": [{ "name": "Coupon card" }]
}
{% endschema %}
