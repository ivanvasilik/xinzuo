{%- liquid
  assign product = closest.product
  assign block_settings = block.settings
  
  # Get the correct collection - prioritize specific series collections over generic ones
  # If accessed from collection page, use that collection. Otherwise, find the series collection.
  if collection
    assign current_collection = collection
  else
    # Filter out generic collections and find the series collection
    assign current_collection = null
    for coll in product.collections
      # Skip generic "all" or "knives" collections - look for series-specific ones
      unless coll.handle contains 'all' or coll.handle == 'knives'
        assign current_collection = coll
        break
      endunless
    endfor
    
    # Fallback to first collection if no series found
    if current_collection == null
      assign current_collection = product.collections.first
    endif
  endif
-%}

<div class="product-title-custom" {{ block.shopify_attributes }}>
  {% if block_settings.show_breadcrumbs %}
    <div class="product-details-links">
      <span>
        <a href="/">Home</a>
        <span>></span>
        {% if block_settings.show_knives_link %}
          <a href="/collections/all">KNIVES</a>
          <span>></span>
        {% endif %}
        <span>{{ current_collection.title }}</span>
      </span>
    </div>
  {% endif %}
  
  <h2 id="product-variant-title" class="product-title">{{ current_collection.title }} â€” {{ product.title }}</h2>
</div>

{% stylesheet %}
  .product-title-custom {
    width: 100%;
  }

  .product-details-links {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 16px;
  }

  .product-details-links > span {
    display: flex;
    gap: 6px;
  }

  .product-details-links span {
    font-family: "Sen";
    font-weight: 400;
    font-size: 14px;
    color: #c9c9cc;
  }

  .product-details-links a {
    color: #c9c9cc;
  }

  .product-title {
    font-family: "Sen";
    font-weight: 600;
    font-size: 36px;
    line-height: 135%;
    color: #fff;
    margin: 0;
  }

  @media screen and (max-width: 750px) {
    .product-title {
      font-size: 22px;
    }
  }
{% endstylesheet %}

{% schema %}
{
  "name": "Product Title",
  "tag": null,
  "settings": [
    {
      "type": "checkbox",
      "id": "show_breadcrumbs",
      "label": "Show Breadcrumbs",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_knives_link",
      "label": "Show 'KNIVES' in Breadcrumbs",
      "default": true,
      "info": "Adds 'KNIVES' link between Home and Collection"
    }
  ]
}
{% endschema %}