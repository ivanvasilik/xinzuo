{%- doc -%}
  @param [limit] - {number}
  @param [live_region] - {boolean}

  The maximum number of items in the cart to display. If the number of items in the cart is greater than this limit, the
  count will be displayed as "99+".
{%- enddoc -%}

<div
  ref="cartBubble"
  class="cart-bubble{% if cart == empty %} visually-hidden{% endif %}"
  {% assign item_count = cart.item_count %}
  {% if item_count <= 99 %}
    data-maintain-ratio
  {% endif %}
>
  <span class="cart-bubble__background"></span>
  <span
    ref="cartBubbleText"
    class="cart-bubble__text"
    {% if live_region %}
      role="status"
    {% endif %}
  >
    <span class="visually-hidden">
      {{- 'accessibility.cart_count' | t -}}
      : {{ cart.item_count }}
    </span>
    <span
      class="cart-bubble__text-count{% if cart == empty %} hidden{% endif %}"
      ref="cartBubbleCount"
      aria-hidden="true"
      data-testid="cart-bubble"
    >
      {%- if limit == blank or cart.item_count < limit %}
        {% assign fee_quantity = 0 %}
        {% for item in cart.items %}
          {% if item.variant_id == 43781283217459 or item.variant_id == 43781283250227 %}
            {% assign fee_quantity = fee_quantity | plus: item.quantity %}
          {% endif %}
        {% endfor %}
        {{- cart.item_count | minus: fee_quantity -}}
      {%- endif -%}
    </span>
    {% if limit == blank or cart.item_count < limit %}
      <span class="cart-bubble-item">&nbsp;Items</span>
    {% endif %}
  </span>
</div>
