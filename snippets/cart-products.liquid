{% assign block_settings = block.settings %}

<script
  src="{{ 'component-cart-items.js' | asset_url }}"
  type="module"
  fetchpriority="low"
></script>

{% style %}
  .cart-description {
    display: flex;
    gap: 16px;
    align-items: center;
  }

  .cart-description div {
    display: flex;
    gap: 10px;
    align-items: center;
  }
{% endstyle %}

<div
  {{ block.shopify_attributes }}
  class="cart-items__wrapper"
  {% if settings.product_title_case == 'uppercase' %}
    style="--product-title-case: uppercase;"
  {% endif %}
>
  {% if cart.empty? %}
    {%- if shop.customer_accounts_enabled and customer == null -%}
      <p>
        {{ 'actions.log_in_html' | t: link: routes.account_login_url }}
      </p>
    {%- endif -%}

    <a
      class="button cart-items__empty-button"
      href="{{ settings.empty_cart_button_link | default: routes.all_products_collection_url }}"
    >
      {{ 'actions.continue_shopping' | t }}
    </a>
  {%- else -%}
    <span
      class="visually-hidden"
      ref="cartItemCount"
      aria-hidden="true"
    >
      {{- cart.item_count -}}
    </span>
    <form
      action="{{ routes.cart_url }}"
      class="cart-form"
      id="cart-form"
      method="post"
    >
      <div
        class="cart-items spacing-style{% if block_settings.dividers %} cart-items--dividers{% endif %}"
        style="{%  render 'spacing-style', settings: block_settings %} --cart-items-gap:{{ block_settings.gap | append: "px" }};"
      >
        <table
          class="cart-items__table"
          role="table"
        >
          <caption
            class="visually-hidden"
            role="caption"
          >
            {{ 'content.cart_total' | t }}
            <span>{{ cart.total_price | money_with_currency }}</span>
          </caption>

          <thead
            class="visually-hidden"
            role="rowgroup"
          >
            <tr
              role="row"
              class="cart-items__table-row"
            >
              <th
                id="productImage"
                scope="col"
                role="columnheader"
              >
                {{ 'content.product_image' | t }}
              </th>
              <th
                id="productInformation"
                scope="col"
                role="columnheader"
              >
                {{ 'content.product_information' | t }}
              </th>
              <th
                id="quantity"
                scope="col"
                role="columnheader"
              >
                {{ 'content.quantity' | t }}
              </th>
              <th
                id="productTotal"
                scope="col"
                role="columnheader"
              >
                {{ 'content.product_total' | t }}
              </th>
            </tr>
          </thead>

          <tbody role="rowgroup">
            {% for item in cart.items %}
              <tr
                role="row"
                class="cart-items__table-row{% if item.parent_relationship.parent != null %} cart-items__nested-line{% endif %}"
                ref="cartItemRows[]"
                data-parent-key="{{ item.parent_relationship.parent.key }}"
                data-key="{{ item.key }}"
              >
                {% comment %} {% if type != "drawer" %}
                  <td
                    class="cart-items__media"
                    role="cell"
                    headers="productImage"
                  >
                    {% if item.image -%}
                      {% liquid
                        assign ratio = 1
                        assign border_opacity = settings.cart_thumbnail_border_opacity | divided_by: 100.0
                        assign border_override = '--border-width: [cart_thumbnail_border_width]px; --border-style: [cart_thumbnail_border_style]; --border-color: rgb(var(--color-border-rgb) / [cart_thumbnail_border_opacity]); --border-radius: [cart_thumbnail_border_radius]px;' | replace: '[cart_thumbnail_border_width]', settings.cart_thumbnail_border_width | replace: '[cart_thumbnail_border_style]', settings.cart_thumbnail_border | replace: '[cart_thumbnail_border_opacity]', border_opacity | replace: '[cart_thumbnail_border_radius]', settings.cart_thumbnail_border_radius

                        if settings.cart_thumbnail_border_radius > 0
                          assign border_override = border_override | append: ' overflow: hidden;'
                        endif
                        if block_settings.image_ratio == 'portrait'
                          assign ratio = 0.8
                        elsif block_settings.image_ratio == 'adapt'
                          assign ratio = item.image.aspect_ratio
                        endif
                      %}
                      <a
                        href="{{ item.url }}"
                        class="cart-items__media-container"
                      >
                        {%- liquid
                          echo item.image | image_url: width: 250 | image_tag: class: 'cart-items__media-image border-style', style: border_override
                        -%}
                      </a>
                    {%- endif %}
                  </td>
                  <td
                    class="cart-items__details cart-primary-typography"
                    role="cell"
                    headers="productInformation"
                  >
                    <p>
                      <a
                        href="{{ item.url }}"
                        class="cart-items__title"
                        {% if item.parent_relationship.parent != null %}
                          aria-label="{{ 'accessibility.nested_product' | t: product_title: item.product.title, parent_title: item.parent_relationship.parent.title | escape }}"
                        {% endif %}
                      >
                        {{ item.title }}
                      </a>
                    </p>
                    {% if item.product.vendor and block_settings.vendor %}
                      <p>
                        {{ item.product.vendor }}
                      </p>
                    {% endif %}

                    {%- if item.item_components.size != 0 -%}
                      <ul class="cart-items__bundle list-unstyled">
                        {%- for component in item.item_components -%}
                          <li>
                            {{- component.title -}}
                            {%- if component.quantity > 1 -%}
                              <span> Ã— {{ component.quantity }}</span>
                            {%- endif -%}
                          </li>
                        {%- endfor -%}
                      </ul>
                    {%- endif -%}

                    {%- if item.product.has_only_default_variant == false
                      or item.properties.size != 0
                      or item.selling_plan_allocation != null
                    -%}
                      <dl class="cart-items__variants">
                        {% comment %} {%- if item.product.has_only_default_variant == false and item.item_components.size == 0 -%}
                          {%- for option in item.options_with_values -%}
                            <div class="cart-items__variant">
                              <dt class="visually-hidden">{{ option.name }}:</dt>
                              <dd>
                                {{- option.value -}}
                                {%- if forloop.last != true %},&nbsp;{% endif -%}
                              </dd>
                            </div>
                          {%- endfor -%}
                        {%- endif -%} {% endcomment %}

                        {%- for property in item.properties -%}
                          {%- assign property_first_char = property.first | slice: 0 -%}
                          {%- if property.last != blank and property_first_char != '_' -%}
                            <div class="cart-items__properties">
                              <dt>{{ property.first }}:</dt>
                              <dd>
                                {%- if property.last contains '/uploads/' -%}
                                  <a href="{{ property.last }}">{{ property.last | split: '/' | last }}</a>
                                {%- else -%}
                                  {{ property.last }}
                                {%- endif -%}
                              </dd>
                            </div>
                          {%- endif -%}
                        {%- endfor -%}
                      </dl>

                      {% if item.selling_plan_allocation %}
                        <p>{{ item.selling_plan_allocation.selling_plan.name }}</p>
                      {% endif %}
                    {%- endif -%}

                    {% if item.line_level_discount_allocations.size > 0 %}
                      <ul
                        class="list-unstyled"
                        role="list"
                      >
                        {%- for discount in item.line_level_discount_allocations -%}
                          <li>{{ discount.discount_application.title | escape }}</li>
                        {%- endfor -%}
                      </ul>
                    {% endif %}

                    <div>
                      {{ item.description | truncate: 50, "..." }}
                    </div>
                    <div class="cart-description">
                      {% if item.variant.metafields.custom.angle %}
                        <div>
                          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none">
                            <g clip-path="url(#clip0_6018_13468)">
                              <path d="M6.5 4.5C8.0913 4.5 9.61742 5.13214 10.7426 6.25736C11.8679 7.38258 12.5 8.9087 12.5 10.5" stroke="#FF0004" stroke-linecap="round" stroke-linejoin="round"/>
                              <path d="M4.5 2V12.5H15" stroke="#FF0004" stroke-linecap="round" stroke-linejoin="round"/>
                              <path d="M2 4.5H4.5" stroke="#FF0004" stroke-linecap="round" stroke-linejoin="round"/>
                            </g>
                            <defs>
                              <clipPath id="clip0_6018_13468">
                                <rect width="16" height="16" fill="white"/>
                              </clipPath>
                            </defs>
                          </svg>
                          <span>{{ item.variant.metafields.custom.angle.value }}deg</span>
                        </div>
                      {% endif %}
                      {% if item.variant.metafields.custom.thick %}
                        <div>
                          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none">
                            <g clip-path="url(#clip0_6018_13476)">
                              <path d="M8.89971 2.51375L14.366 12.0056C14.7491 12.6744 14.2541 13.5 13.4653 13.5H2.53284C1.74409 13.5 1.24909 12.6744 1.63221 12.0056L7.09846 2.51375C7.49221 1.82875 8.50596 1.82875 8.89971 2.51375Z" stroke="#FF0004" stroke-linecap="round" stroke-linejoin="round"/>
                            </g>
                            <defs>
                              <clipPath id="clip0_6018_13476">
                                <rect width="16" height="16" fill="white"/>
                              </clipPath>
                            </defs>
                          </svg>
                          <span>{{ item.variant.metafields.custom.thick.value }}mm Thick</span>
                        </div>
                      {% endif %}
                      {% if item.variant.metafields.custom.material %}
                        <div>
                          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none">
                            <g clip-path="url(#clip0_6018_13558)">
                              <path d="M4.0004 13.5C3.86779 13.5 3.74061 13.4473 3.64685 13.3535C3.55308 13.2598 3.5004 13.1326 3.5004 13V10.3319C3.23367 10.4581 2.93935 10.5148 2.64483 10.4967C2.3503 10.4786 2.06512 10.3864 1.81581 10.2286C1.5665 10.0707 1.36115 9.85237 1.21886 9.59387C1.07657 9.33536 1.00195 9.04507 1.00195 8.74999C1.00195 8.45491 1.07657 8.16462 1.21886 7.90612C1.36115 7.64761 1.5665 7.42928 1.81581 7.27143C2.06512 7.11358 2.3503 7.02134 2.64483 7.00327C2.93935 6.98521 3.23367 7.04192 3.5004 7.16812V4.49999C3.5004 4.36738 3.55308 4.24021 3.64685 4.14644C3.74061 4.05267 3.86779 3.99999 4.0004 3.99999H6.91852C6.79219 3.73326 6.73536 3.4389 6.75333 3.14431C6.77131 2.84971 6.8635 2.56445 7.02133 2.31505C7.17916 2.06566 7.39751 1.86023 7.65605 1.71788C7.9146 1.57553 8.20494 1.50089 8.50009 1.50089C8.79523 1.50089 9.08558 1.57553 9.34412 1.71788C9.60267 1.86023 9.82101 2.06566 9.97884 2.31505C10.1367 2.56445 10.2289 2.84971 10.2468 3.14431C10.2648 3.4389 10.208 3.73326 10.0816 3.99999H13.0004C13.133 3.99999 13.2602 4.05267 13.354 4.14644C13.4477 4.24021 13.5004 4.36738 13.5004 4.49999V7.16812C13.2337 7.04192 12.9394 6.98521 12.6448 7.00327C12.3503 7.02134 12.0651 7.11358 11.8158 7.27143C11.5665 7.42928 11.3612 7.64761 11.2189 7.90612C11.0766 8.16462 11.002 8.45491 11.002 8.74999C11.002 9.04507 11.0766 9.33536 11.2189 9.59387C11.3612 9.85237 11.5665 10.0707 11.8158 10.2286C12.0651 10.3864 12.3503 10.4786 12.6448 10.4967C12.9394 10.5148 13.2337 10.4581 13.5004 10.3319V13C13.5004 13.1326 13.4477 13.2598 13.354 13.3535C13.2602 13.4473 13.133 13.5 13.0004 13.5H4.0004Z" stroke="#FF0004" stroke-linecap="round" stroke-linejoin="round"/>
                            </g>
                            <defs>
                              <clipPath id="clip0_6018_13558">
                                <rect width="16" height="16" fill="white"/>
                              </clipPath>
                            </defs>
                          </svg>
                          <span>{{ item.variant.metafields.custom.material.value }}</span>
                        </div>
                      {% endif %}
                    </div>
                    {% comment %} <div>
                      {% if item.original_price != item.final_price %}
                        <span class="visually-hidden">{{ 'content.price_sale' | t }}</span>
                        <span>{{ item.final_price | money }}</span>
                        <span class="visually-hidden">{{ 'content.price_regular' | t }}</span>
                        <s class="compare-at-price">
                          {% if item.variant.compare_at_price > item.original_price %}
                            {{ item.variant.compare_at_price | money }}
                          {% else %}
                            {{ item.original_price | money }}
                          {% endif %}
                        </s>
                      {% else %}
                        {% if item.variant.compare_at_price > item.original_price %}
                          <span class="visually-hidden">{{ 'content.price_sale' | t }}</span>
                        {% else %}
                          <span class="visually-hidden">{{ 'content.price' | t }}</span>
                        {% endif %}

                        <span>{{ item.original_price | money }}</span>

                        {% if item.variant.compare_at_price > item.original_price %}
                          <span class="visually-hidden">{{ 'content.price_regular' | t }}</span>
                          <s class="compare-at-price">{{ item.variant.compare_at_price | money }}</s>
                        {% endif %}
                      {% endif %}
                    </div> {% endcomment %}
                  </td>
                  {% comment %} <td
                    class="cart-items__quantity"
                    role="cell"
                    headers="quantity"
                  >
                    {% # Here I want to pass some arguments to the quantity block so it knows which value should the input be set to. Though quantity block could be a snippet instead %}
                    {% assign can_update_quantity = item.instructions.can_update_quantity
                      | default: true, allow_false: true
                    %}
                    {% render 'quantity-selector',
                      product: item.product,
                      in_cart_quantity: item.quantity,
                      line_index: item.index,
                      min: 0,
                      class: 'cart-primary-typography',
                      can_update_quantity: can_update_quantity
                    %}

                    <button
                      class="button button--tertiary cart-items__remove"
                      type="button"
                      aria-label="{{ 'accessibility.remove_item' | t: title: item.title | escape }}"
                      on:click="/onLineItemRemove/{{ item.index | plus: 1 }}"
                      {% assign can_remove = item.instructions.can_remove | default: true, allow_false: true %}
                      {% if can_remove == false %}
                        hidden
                      {% endif %}
                    >
                      {{- 'icon-delete.svg' | inline_asset_content -}}
                      <span class="visually-hidden">Remove</span>
                    </button>
                  </td> {% endcomment %}
                  <td
                    class="cart-items__error hidden"
                    role="cell"
                    ref="cartItemErrorContainer-{{ item.index | plus: 1 }}"
                    headers="quantity"
                  >
                    <div
                      class="cart-item__error"
                      role="alert"
                    >
                      <span class="svg-wrapper">
                        {{- 'icon-error.svg' | inline_asset_content -}}
                      </span>
                      <small
                        class="cart-item__error-text cart-primary-typography"
                        ref="cartItemError-{{ item.index | plus: 1 }}"
                      ></small>
                    </div>
                  </td>
                  <td
                    class="cart-items__price cart-secondary-typography"
                    role="cell"
                    headers="productTotal"
                  >
                    {% comment %} {%- liquid
                      if settings.currency_code_enabled_cart_items
                        assign price = item.final_line_price | money_with_currency
                        assign unit_price = item.unit_price | money_with_currency
                      else
                        assign price = item.final_line_price | money
                        assign unit_price = item.unit_price | money
                      endif
                    -%}
                    <text-component value="{{ price | strip_html }}">{{ price }}</text-component>
                    {%- if item.unit_price_measurement -%}
                      <div class="cart-items__price-unit cart-secondary-typography">
                        {% render 'unit-price', price: unit_price, measurement: item.unit_price_measurement %}
                      </div>
                    {%- endif -%} {% endcomment %}
                    <div>
                      {% if item.original_price != item.final_price %}
                        <span class="visually-hidden">{{ 'content.price_regular' | t }}</span>
                        <s class="compare-at-price">
                          {% if item.variant.compare_at_price > item.original_price %}
                            {{ item.variant.compare_at_price | money }}
                          {% else %}
                            {{ item.original_price | money }}
                          {% endif %}
                        </s>
                        <span class="visually-hidden">{{ 'content.price_sale' | t }}</span>
                        <span>{{ item.final_price | money }}</span>
                      {% else %}
                        {% if item.variant.compare_at_price > item.original_price %}
                          <span class="visually-hidden">{{ 'content.price_sale' | t }}</span>
                        {% else %}
                          <span class="visually-hidden">{{ 'content.price' | t }}</span>
                        {% endif %}
                        {% if item.variant.compare_at_price > item.original_price %}
                          <span class="visually-hidden">{{ 'content.price_regular' | t }}</span>
                          <s class="compare-at-price">{{ item.variant.compare_at_price | money }}</s>
                        {% endif %}
                        <span>{{ item.original_price | money }}</span>
                      {% endif %}
                    </div>
                    <div>
                      <button
                        class="button button--tertiary cart-items__remove"
                        type="button"
                        aria-label="{{ 'accessibility.remove_item' | t: title: item.title | escape }}"
                        on:click="/onLineItemRemove/{{ item.index | plus: 1 }}"
                        {% assign can_remove = item.instructions.can_remove | default: true, allow_false: true %}
                        {% if can_remove == false %}
                          hidden
                        {% endif %}
                      >
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none">
                          <g clip-path="url(#clip0_4235_13535)">
                            <path d="M13.5 3.5H2.5" stroke="#c9c9cc" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M5.5 1.5H10.5" stroke="#c9c9cc" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M12.5 3.5V13C12.5 13.1326 12.4473 13.2598 12.3536 13.3536C12.2598 13.4473 12.1326 13.5 12 13.5H4C3.86739 13.5 3.74021 13.4473 3.64645 13.3536C3.55268 13.2598 3.5 13.1326 3.5 13V3.5" stroke="#c9c9cc" stroke-linecap="round" stroke-linejoin="round"/>
                          </g>
                          <defs>
                            <clipPath id="clip0_4235_13535">
                              <rect width="16" height="16" fill="white"/>
                            </clipPath>
                          </defs>
                        </svg>
                        {% comment %} {{- 'icon-delete.svg' | inline_asset_content -}} {% endcomment %}
                        <span class="visually-hidden">Remove</span>
                      </button>
                    </div>
                    <div>
                      {% assign can_update_quantity = item.instructions.can_update_quantity
                        | default: true, allow_false: true
                      %}
                      {% render 'quantity-selector',
                        product: item.product,
                        in_cart_quantity: item.quantity,
                        line_index: item.index,
                        min: 0,
                        class: 'cart-primary-typography',
                        can_update_quantity: can_update_quantity
                      %}
                    </div>
                  </td>
                {% else %} {% endcomment %}
                  <td class="cart-drawer-img">
                    {% if item.image -%}
                      {% liquid
                        assign ratio = 1
                        assign border_opacity = settings.cart_thumbnail_border_opacity | divided_by: 100.0
                        assign border_override = '--border-width: [cart_thumbnail_border_width]px; --border-style: [cart_thumbnail_border_style]; --border-color: rgb(var(--color-border-rgb) / [cart_thumbnail_border_opacity]); --border-radius: [cart_thumbnail_border_radius]px;' | replace: '[cart_thumbnail_border_width]', settings.cart_thumbnail_border_width | replace: '[cart_thumbnail_border_style]', settings.cart_thumbnail_border | replace: '[cart_thumbnail_border_opacity]', border_opacity | replace: '[cart_thumbnail_border_radius]', settings.cart_thumbnail_border_radius

                        if settings.cart_thumbnail_border_radius > 0
                          assign border_override = border_override | append: ' overflow: hidden;'
                        endif
                        if block_settings.image_ratio == 'portrait'
                          assign ratio = 0.8
                        elsif block_settings.image_ratio == 'adapt'
                          assign ratio = item.image.aspect_ratio
                        endif
                      %}
                      <a
                        href="{{ item.url }}"
                        class="cart-items__media-container"
                      >
                        {%- liquid
                          echo item.image | image_url: width: 250 | image_tag: class: 'cart-items__media-image border-style', style: border_override
                        -%}
                      </a>
                    {%- endif %}
                  </td>
                  <td class="cart-drawer-info">
                    <div class="cart-drawer-info-div1">
                      <div class="cart-drawer-product">
                        <a href="{{ item.url }}">
                          <h5 class="cart-items__title">{{ item.title }}</h5>
                        </a>
                        {% comment %} <p>
                          <a
                            href="{{ item.url }}"
                            class="cart-items__title"
                            {% if item.parent_relationship.parent != null %}
                              aria-label="{{ 'accessibility.nested_product' | t: product_title: item.product.title, parent_title: item.parent_relationship.parent.title | escape }}"
                            {% endif %}
                          >
                            {{ item.title }}
                          </a>
                        </p> {% endcomment %}
                        <span>{{ item.variant.metafields.custom.description.value | truncate: 25, "..." }}</span>
                      </div>
                      <div class="cart-product-remove">
                        <button
                          class="button button--tertiary cart-items__remove"
                          type="button"
                          aria-label="{{ 'accessibility.remove_item' | t: title: item.title | escape }}"
                          on:click="/onLineItemRemove/{{ item.index | plus: 1 }}"
                          {% assign can_remove = item.instructions.can_remove | default: true, allow_false: true %}
                          {% if can_remove == false %}
                            hidden
                          {% endif %}
                        >
                          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none">
                            <g clip-path="url(#clip0_4235_13535)">
                              <path d="M13.5 3.5H2.5" stroke="#c9c9cc" stroke-linecap="round" stroke-linejoin="round"/>
                              <path d="M5.5 1.5H10.5" stroke="#c9c9cc" stroke-linecap="round" stroke-linejoin="round"/>
                              <path d="M12.5 3.5V13C12.5 13.1326 12.4473 13.2598 12.3536 13.3536C12.2598 13.4473 12.1326 13.5 12 13.5H4C3.86739 13.5 3.74021 13.4473 3.64645 13.3536C3.55268 13.2598 3.5 13.1326 3.5 13V3.5" stroke="#c9c9cc" stroke-linecap="round" stroke-linejoin="round"/>
                            </g>
                            <defs>
                              <clipPath id="clip0_4235_13535">
                                <rect width="16" height="16" fill="white"/>
                              </clipPath>
                            </defs>
                          </svg>
                          {% comment %} {{- 'icon-delete.svg' | inline_asset_content -}} {% endcomment %}
                          <span class="visually-hidden">Remove</span>
                        </button>
                      </div>
                    </div>
                    <div class="cart-drawer-info-div2">
                      <div class="cart-drawer-price">
                        {% if item.original_price != item.final_price %}
                          <span class="visually-hidden">{{ 'content.price_sale' | t }}</span>
                          <span>{{ item.final_price | money }}</span>
                          <span class="visually-hidden">{{ 'content.price_regular' | t }}</span>
                          <s class="compare-at-price">
                            {% if item.variant.compare_at_price > item.original_price %}
                              {{ item.variant.compare_at_price | money }}
                            {% else %}
                              {{ item.original_price | money }}
                            {% endif %}
                          </s>
                        {% else %}
                          <span>{{ item.original_price | money }}</span>
                          {% if item.variant.compare_at_price > item.original_price %}
                            <span class="visually-hidden">{{ 'content.price_sale' | t }}</span>
                          {% else %}
                            <span class="visually-hidden">{{ 'content.price' | t }}</span>
                          {% endif %}
                          {% if item.variant.compare_at_price > item.original_price %}
                            <span class="visually-hidden">{{ 'content.price_regular' | t }}</span>
                            <s class="compare-at-price">{{ item.variant.compare_at_price | money }}</s>
                          {% endif %}
                        {% endif %}
                      </div>
                      <div class="cart-drawer-quantity">
                        {% assign can_update_quantity = item.instructions.can_update_quantity
                          | default: true, allow_false: true
                        %}
                        {% render 'quantity-selector',
                          product: item.product,
                          in_cart_quantity: item.quantity,
                          line_index: item.index,
                          min: 0,
                          class: 'cart-primary-typography',
                          can_update_quantity: can_update_quantity
                        %}
                      </div>
                    </div>
                  </td>
                {% comment %} {% endif %} {% endcomment %}
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </form>
  {%- endif -%}
</div>

{% unless cart.empty? %}
  {% if section.settings.products != blank %}
    <div class="cart-slider">
      <h2>{{ section.settings.heading }}</h2>
      <div class="cart-swiper">
        <div class="swiper-wrapper">
          {% for product in section.settings.products %}
            <div class="swiper-slide">
              <img src="{{ product.featured_image | img_url: 'master' }}" width="100%" height="100%" alt="collection slider {{ forloop.index }}">
              {% assign collection = product.collections | first %}
              <h2>{{- collection.title -}}&nbsp;-&nbsp;{{- product.title -}}</h2>
              <div class="product-reviews"></div>
              <div class="product-price">
                  <span class="prices">
                      <span class="sale-price">{{ product.price | money }}</span>
                      <span class="compare-price">{{ product.compare_at_price | money }}</span>
                  </span>
              </div>
              {% comment %} {% liquid
                if product.available
                  assign can_add_to_cart = true
                  assign add_to_cart_text = 'products.product.add_to_cart' | t
                else
                  assign can_add_to_cart = false
                  assign add_to_cart_text = 'products.product.sold_out' | t
                endif
              %}
              {% render 'add-to-cart-button',
                id: 'Cart-page-slider-' | append: product.id,
                class: 'add-to-cart-button',
                can_add_to_cart: can_add_to_cart,
                product: product,
                add_to_cart_text: add_to_cart_text
              %} {% endcomment %}
            </div>
          {% endfor %}
        </div>
      </div>
      <div class="cart-swiper-buttons">
          <div class="cart-swiper-button-prev">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
                  <g clip-path="url(#clip0_4030_26868)">
                      <path d="M15 19.5L7.5 12L15 4.5" stroke="#c9c9cc" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </g>
                  <defs>
                      <clipPath id="clip0_4030_26868">
                          <rect width="24" height="24" fill="white"/>
                      </clipPath>
                  </defs>
              </svg>
          </div>
          <div class="cart-swiper-button-next">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
                  <g clip-path="url(#clip0_4030_26872)">
                      <path d="M9 4.5L16.5 12L9 19.5" stroke="#c9c9cc" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </g>
                  <defs>
                      <clipPath id="clip0_4030_26872">
                          <rect width="24" height="24" fill="white"/>
                      </clipPath>
                  </defs>
              </svg>
          </div>
      </div>
    </div>
  {% endif %}
{% endunless %}

{% stylesheet %}
  .cart-items {
    --cart-item-media-width-min: 2.5rem;
    --cart-item-media-width-max: 7.5rem;

    container-name: cart-items;
    container-type: inline-size;
    width: 100%;
  }

  .cart-items-disabled {
    pointer-events: none;
  }

  .cart-items__table {
    width: 100%;
  }

  .cart-items__table * {
    margin: 0;
  }

  .cart-items__table-row {
    --cart-item-price-width: 6rem;

    display: grid;
    grid-template-columns: 120px auto;
    /* grid-template-columns: clamp(2.5rem, 15cqi, 7.5rem) minmax(0, 1fr) minmax(var(--cart-item-price-width), auto);
    grid-template-areas:
      'media details price'
      'media quantity price'
      'media error error'; */
    column-gap: 25px;
    align-items: start;
    padding-bottom: var(--cart-items-gap);
    margin-bottom: var(--margin-lg);
  }

  .cart-items__table-row.cart-items__nested-line td:first-child {
    width: 60%;
    justify-self: right;
  }

  html:active-view-transition-type(page-navigation) .cart-items__table-row {
    /* stylelint-disable-next-line declaration-no-important */
    view-transition-name: none !important;
  }

  .cart-items__table-row.removing {
    overflow: hidden;
    animation: removeRow calc(var(--animation-speed) * 2) var(--animation-easing) forwards;
    animation-delay: var(--animation-speed);
  }

  @keyframes removeRow {
    0% {
      height: var(--row-height);
    }

    100% {
      opacity: 0;
      height: 0;
      padding-bottom: 0;
      margin-bottom: 0;
      border-color: transparent;
    }
  }

  /* .cart-items__table-row:last-child {
    padding-bottom: 0;
  } */

  .cart-items--dividers .cart-items__table-row {
    /* border-bottom: 1px solid var(--color-border); */
    margin-bottom: var(--cart-items-gap);
  }

  .cart-items--dividers .cart-items__table-row:has(+ .cart-items__nested-line) {
    border-bottom: none;
    margin-bottom: 0;
  }

  /* .cart-items--dividers .cart-items__table-row:last-child {
    border-block-end: none;
    padding-block-end: 0;
    margin-bottom: 0;
  } */

  .cart-items__details {
    grid-area: details;
    color: rgb(var(--color-foreground-rgb) / var(--opacity-70));
  }

  .cart-items__details > * + *,
  .cart-items__bundle li {
    margin-block-start: var(--margin-2xs);
  }

  .cart-items__details * {
    font-size: var(--cart-font-size--sm);
  }

  .cart-items__details a {
    text-decoration: none;
  }

  .cart-items__title {
    color: var(--color-foreground);
    text-transform: var(--product-title-case);
    font-family: "Sen";
    font-weight: 600;
    font-size: 16px;
  }

  .cart-items__variant {
    display: inline-block;
  }

  .cart-items__quantity {
    grid-area: quantity;
    margin-block-start: var(--margin-xs);
    display: flex;
    align-items: center;
    justify-content: flex-start;
    gap: var(--gap-xs);
    width: fit-content;
  }

  .cart-items__quantity .quantity-selector {
    display: inline-flex;
    flex: 0 1 var(--quantity-selector-width);
    font-size: var(--cart-font-size--sm);
    height: auto;
  }

  .cart-items__remove {
    background-color: transparent;
    color: var(--color-foreground);
    width: var(--minimum-touch-target);
    height: var(--minimum-touch-target);
    justify-content: center;
    box-shadow: none;
    padding: 0;
  }

  .cart-items__media {
    grid-area: media;
    padding: 0;
  }

  .cart-items__price {
    grid-area: price;
    min-height: unset;
    min-width: var(--cart-item-price-width);
    text-align: end;
    display: block;
    font-size: var(--cart-font-size--md);
  }

  .cart-items__price-unit {
    font-size: var(--cart-font-size--xs);
  }

  .cart-items__media-container {
    display: flex;
    aspect-ratio: var(--ratio);
    position: relative;
    width: 100%;
    overflow: hidden;
  }

  .cart-page .cart-items__media-image {
    aspect-ratio: inherit;
    object-fit: cover;
    object-position: center center;
    width: 100%;
  }

  .cart-items__empty-button {
    margin-top: var(--margin-md);
    padding-inline: var(--padding-4xl);
    padding-block: var(--padding-lg);
  }

  /* Error message */
  .cart-items__error {
    display: flex;
    align-items: flex-start;
    width: 100%;
    grid-area: error;
    margin-block-start: var(--margin-xs);
    opacity: 1;
    overflow: hidden;
    transform: translateY(0);
    transition: opacity var(--drawer-animation-speed) var(--animation-easing),
      transform var(--drawer-animation-speed) var(--animation-easing);

    @starting-style {
      opacity: 0;
      transform: translateY(-0.5rem);
    }
  }

  .cart-item__error {
    display: flex;
    align-items: flex-start;
    width: 100%;
    font-size: var(--cart-font-size--sm);
    padding-block: var(--padding-2xs);
  }

  .cart-item__error .svg-wrapper {
    flex-shrink: 0;
    width: var(--icon-size-xs);
    height: var(--icon-size-xs);
    margin-inline: var(--margin-3xs) var(--margin-xs);
    margin-block-start: var(--margin-3xs);
  }

  @container cart-items (min-width: 720px) {
    .cart-items__table-row {
      --cart-item-price-width: 6rem;

      /* grid-template-columns: 10rem 1fr minmax(var(--cart-item-price-width), auto); */
      grid-template-rows: min-content 1fr;
      grid-template-columns: 120px auto;
      /* grid-template-areas:
        'media details quantity price'
        'media details error error'; */
    }

    .cart-items__quantity,
    .cart-items__price {
      grid-area: initial;
    }

    .cart-items__quantity {
      margin-top: 0;
    }

    .cart-items__price {
      min-height: var(--minimum-touch-target);
      display: flex;
      flex-direction: column;
      align-items: flex-end;
      justify-content: center;
    }
  }

  .cart__original-total-container,
  .cart__total-container {
    display: flex;
    flex-direction: column;
  }

  .cart__total-container {
    row-gap: var(--gap-2xs);

    &:has(.cart__installments) {
      row-gap: var(--gap-xs);
    }
  }

  .cart__original-total-container:empty {
    display: none;
  }

  .cart__summary-totals {
    display: flex;
    flex-direction: column;
    gap: var(--gap-xl);
    width: 100%;
    border-block-start: none;

    &:has(> :first-child:not(.cart__original-total-container, .cart__total-container)) {
      padding-block-start: 0;
      border-block-start: none;
    }

    @media screen and (min-width: 750px) {
      padding-block-start: 0;
    }
  }

  .cart__original-total-container,
  .cart__original-total-container * {
    font-size: var(--cart-font-size--sm);
  }

  .cart__total {
    font-weight: var(--font-weight-bold);
  }

  .cart__total-label {
    font-size: var(--cart-font-size--sm);
  }

  .cart__total-value {
    font-size: var(--cart-font-size--2xl);
  }

  .cart-primary-typography {
    font-family: var(--cart-primary-font-family);
    font-style: var(--cart-primary-font-style);
    font-weight: var(--cart-primary-font-weight);
  }

  .cart-secondary-typography {
    font-family: var(--cart-secondary-font-family);
    font-style: var(--cart-secondary-font-style);
    font-weight: var(--cart-secondary-font-weight);
  }

  .cart__ctas {
    width: 100%;
    display: grid;
    gap: var(--checkout-button-gap);
    grid-auto-flow: row;
    grid-template-columns: 1fr;
  }

  @media screen and (max-width: 750px) {
    .cart__ctas {
      margin-bottom: 20px;
    }
  }

  .cart__additional-checkout-buttons {
    width: 100%;
  }

  .cart__ctas .cart__checkout-button {
    width: 100%;
    height: clamp(25px, var(--height-buy-buttons), 55px);
    padding-inline: var(--padding-4xl);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 5px;
  }

  shopify-accelerated-checkout-cart {
    --shopify-accelerated-checkout-inline-alignment: center;
    --shopify-accelerated-checkout-button-border-radius: var(--style-border-radius-buttons-primary);
    --shopify-accelerated-checkout-row-gap: var(--checkout-button-gap, 10px);
  }

  .cart-note {
    width: 100%;
  }

  @starting-style {
    .cart-note[open-by-default-on-desktop][open-by-default-on-mobile] .details-content {
      block-size: auto;
      opacity: 1;
      overflow-y: visible;
    }
  }

  .cart-note__inner {
    padding-block: var(--padding-2xs) var(--padding-sm);
  }

  .cart-note__summary {
    display: flex;
    align-items: center;
    justify-content: space-between;
  }

  .cart-note__summary:hover {
    color: rgb(var(--color-foreground-rgb) / var(--opacity-subdued-text));
  }

  .cart-note__label {
    display: flex;
    align-items: flex-start;
    gap: var(--gap-2xs);
    font-size: var(--cart-font-size--sm);
  }

  .cart-note__instructions {
    color: var(--color-input-text);
    background-color: var(--color-input-background);
    border-width: var(--style-border-width-inputs);
    border-color: var(--color-input-border);
    transition: box-shadow var(--animation-speed) ease;
    box-shadow: var(--input-box-shadow);
    min-height: 5.5rem;
    min-width: 100%;
    max-width: 100%;
    font-size: var(--cart-font-size--sm);
    padding: max(4px, calc(var(--style-border-radius-inputs) * (1 - cos(45deg))));
  }

  .cart-note .svg-wrapper {
    height: var(--icon-size-sm);
    width: var(--icon-size-sm);
    margin: 0;
  }

  .cart-note .icon-plus {
    height: var(--icon-size-xs);
    width: var(--icon-size-xs);
  }

  /* Remove animation */
  .remove-icon-bottom,
  .remove-icon-top {
    transition: transform var(--animation-speed) var(--animation-easing);
  }

  .cart-items__remove:hover .remove-icon-top {
    transform: translate(calc(-1 * var(--icon-stroke-width)), var(--icon-stroke-width)) rotate(-15deg);
  }

  .cart-items__remove:is(:hover, :active) .remove-icon-bottom {
    transform: translateY(var(--icon-stroke-width));
  }

  .cart-items__table-row.removing .remove-icon-bottom {
    transform: translateY(0);
  }

  .cart-items__table-row.removing .remove-icon-top {
    animation: removeButtonClickedIconTop var(--animation-speed) var(--animation-easing) forwards;
  }

  @keyframes removeButtonClickedIconTop {
    50% {
      transform: translate(0, calc(-1 * var(--icon-stroke-width)));
    }

    100% {
      transform: translate(0, 0);
    }
  }

  .cart-items__properties {
    display: block;
    margin-block-start: var(--margin-2xs);
  }

  .cart-items__properties dt,
  .cart-items__properties dd {
    display: inline;
  }
{% endstylesheet %}
