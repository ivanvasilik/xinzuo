{%- comment -%}
Minimal, scoped coupon (solid border + filled copy button)
{%- endcomment -%}

{%- assign code = code | default: 'BF20' -%}
{%- assign text = text | default: 'Black Friday ðŸŽ‰ use the coupon above at checkout for 20% off' -%}
{%- assign color = color | default: '#e60013' -%}
{%- assign uid = uid | default: 'coupon' -%}
{%- assign mt = margin_top | default: 12 -%}
{%- assign mb = margin_bottom | default: 0 -%}

<div id="coupon-{{ uid }}" class="coupon-ui" style="--c: {{ color }}; margin: {{ mt }}px 0 {{ mb }}px;">
  <div class="coupon-surface">
    <span class="coupon-label">COUPON:</span>
    <strong class="coupon-code">{{ code }}</strong>
    <button class="coupon-copy" type="button" data-copy="{{ code }}">COPY</button>
  </div>
  <p class="coupon-text">{{ text }}</p>
</div>

<style>
  /* Scope */
  #coupon-{{ uid }} { background: transparent; }

  /* Surface: near-square, subtle radius, solid border */
  #coupon-{{ uid }} .coupon-surface{
    display:flex; align-items:center; gap:.75rem; flex-wrap:nowrap;
    padding:.7rem .9rem;
    border:1px solid rgba(230,0,19,.45); /* brand-red, subtle */
    border-radius:10px;                  /* consistent radius */
    background: transparent;             /* keeps your dark theme clean */
  }

  /* Label and code */
  #coupon-{{ uid }} .coupon-label{
    font-size:.82rem; letter-spacing:.08em; text-transform:uppercase;
    color:#fff; opacity:.9;
  }
  #coupon-{{ uid }} .coupon-code{
    font-family: var(--font-heading--family, inherit);
    font-weight:700; letter-spacing:.06em; color:#fff;
    font-size: clamp(1rem, 2.2vw, 1.125rem);
    white-space:nowrap; max-width:60%; overflow:hidden; text-overflow:ellipsis;
  }

  /* Copy button: filled chip, same radius */
  #coupon-{{ uid }} .coupon-copy{
    margin-left:auto;
    height:30px; padding:0 .75rem;
    border-radius:10px;
    border:1px solid var(--c);
    background: var(--c);
    color:#fff; font-size:.8rem; font-weight:700; letter-spacing:.04em; line-height:1;
    cursor:pointer;
  }
  #coupon-{{ uid }} .coupon-copy:hover{ filter:brightness(1.05); }
  #coupon-{{ uid }} .coupon-copy:focus{ outline:2px solid rgba(255,255,255,.25); outline-offset:2px; }
  #coupon-{{ uid }} .coupon-copy:active{ transform: translateY(1px); }

  /* Subtext */
  #coupon-{{ uid }} .coupon-text{
    margin:.55rem 0 0; font-size:.95rem; color:#c9c9cc;
  }

  /* Mobile tweaks */
  @media (max-width:640px){
    #coupon-{{ uid }} .coupon-surface{ padding:.65rem .8rem; }
    #coupon-{{ uid }} .coupon-copy{ height:28px; padding:0 .65rem; }
  }
</style>

<script>
  document.addEventListener('click', function(e){
    const root = document.getElementById('coupon-{{ uid }}');
    if(!root) return;
    const btn = e.target.closest('#coupon-{{ uid }} .coupon-copy');
    if(!btn) return;
    const code = btn.getAttribute('data-copy') || '';
    if (navigator.clipboard && navigator.clipboard.writeText) {
      navigator.clipboard.writeText(code).then(function(){
        const old = btn.textContent;
        btn.textContent = 'COPIED';
        setTimeout(function(){ btn.textContent = old; }, 900);
      });
    }
  });
</script>
